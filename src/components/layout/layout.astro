---
import Header from "../../components/header/header.astro";
import Footer from "../../components/footer/footer.astro";
import FixedButton from "../../components/fixed-button/fixed-button.astro";
import CompanyIco from "/images/company/Company.ico";
import "../layout/layout.css";

interface Props {
  pageTitle: string;
  pageDescription: string;
}

const { pageTitle, pageDescription } = Astro.props;
const companyInfo = {
  contact: [
    {
      name: "+593 (986) 206-847",
      icon: "fas fa-phone-alt",
      refLink: "#",
    },
    {
      name: "+1 (941) 809-3071",
      icon: "fas fa-phone-alt",
      refLink: "#",
    },
    {
      name: "info@equasystems.com",
      icon: "far fa-envelope",
      refLink: "#",
    },
    {
      name: "Parque Empresarial Colón, Guayas, Cantón Guayaquil.",
      icon: "fas fa-map-marker-alt",
      refLink: "#",
    },
  ],
  socialMedia: [
    {
      name: " Facebook",
      icon: "fab fa-facebook-f",
      refLink: "#",
    },
    {
      name: " Twitter",
      icon: "fab fa-twitter",
      refLink: "#",
    },
    {
      name: " Instagram",
      icon: "fab fa-instagram",
      refLink: "#",
    },
  ],
  siteMap: [
    {
      name: "Inicio",
      refLink: "/",
    },
    {
      name: "Equipo",
      refLink: "/team",
    },
    {
      name: "Servicios",
      refLink: "/services",
    },
    {
      name: "Empresa",
      refLink: "/company",
    },
    {
      name: "Contacto",
      refLink: "/contact-us",
    },
  ],
};
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/ico" href={CompanyIco} />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <meta name="description" content={pageDescription} />
    <meta
      name="keywords"
      content="equipo de desarrollo, desarrollo de software, desarrollo de aplicaciones, programadores expertos, equipo de desarrollo de software, soluciones tecnológicas, desarrollo web, desarrollo móvil, servicios de programación, desarrollo de software personalizado"
    />
    <title>EquaSystems | {pageTitle}</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
      integrity="sha512-LvewiOi2b+g6yJ08p4AVvC5zYVw0SQ7ADvV0wnG5txk0mJ0rKsUNwwlPVXYsGJm+pAK7z7rC69WVW8j/miUOHQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />

  </head>

  <body>
    <Header companyData={companyInfo} />
    <slot />
    <FixedButton />
    <Footer companyData={companyInfo} />

    <script>
      //Carousel
      const slides = document.querySelectorAll(".slider-slide-carousel");
      let currentSlide = 0;
      const slideInterval = 10000;
      function nextSlide() {
        slides[currentSlide]?.classList.remove("active");
        currentSlide = (currentSlide + 1) % slides.length;
        slides[currentSlide]?.classList.add("active");
      }

      setInterval(nextSlide, slideInterval);
      slides[currentSlide]?.classList.add("active");
      //Carousel

      //Header
      const menuBtn = document.querySelector(".burguer");
      const menu = document.querySelector(".menu");
      const navItems = document.querySelectorAll(".menu ul li");

      let showMenu = false;

      menuBtn.addEventListener("click", toggleMenu);

      function toggleMenu() {
        if (!showMenu) {
          menuBtn?.classList.add("active");
          menu?.classList.add("show");
          navItems.forEach((item, index) => {
            item.style.transitionDelay = `${index * 50}ms`;
            item?.classList.add("show");
          });
          showMenu = true;
        } else {
          menuBtn?.classList.remove("active");
          navItems.forEach((item, index) => {
            item.style.transitionDelay = "";
            item?.classList.remove("show");
          });
          setTimeout(() => {
            menu.classList.remove("show");
          }, 500);
          showMenu = false;
        }
      }
      //Header

      import Swal from 'sweetalert2';
      const form = document.getElementById("formEmail");
      
      // Agregar un evento de escucha para el envío del formulario
      form.addEventListener("submit", function (event) {
        event.preventDefault(); // Evita que el formulario se envíe de inmediato
      
        // obtener boton para deshabilitarlo
        const submitButton = form.querySelector('#submitButton') as HTMLInputElement;
      
        // Obtener los valores de los campos de entrada
        const nameInput = form.querySelector('input[name="name"]') as HTMLInputElement;
        const emailInput = form.querySelector('input[name="email"]') as HTMLInputElement;
        const subjectInput = form.querySelector('input[name="subject"]') as HTMLInputElement;
        const messageTextarea = form.querySelector('textarea[name="message"]') as HTMLTextAreaElement;
      
        const name = nameInput.value;
        const email = emailInput.value;
        const subject = subjectInput.value;
        const message = messageTextarea.value;
        submitButton.disabled = true;
      
        // Crear un objeto con los datos del formulario
        const formData = {
          name,
          email,
          subject,
          message,
        };
      
        // Realizar una solicitud POST a la API
        fetch("https://node-express-email.vercel.app/enviar-correo", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(formData),
        })
          .then((response) => {
            if (!response.ok) {
              throw new Error("Hubo un problema al enviar el formulario.");
            }
            return response.json();
          })
          .then((data) => {
            // Manejar la respuesta de la API aquí
            Swal.fire({
              icon: 'success',
              title: 'CORREO ENVIADO'
            });
            submitButton.disabled = false;
            nameInput.value = '';
            emailInput.value = '';
            subjectInput.value = '';
            messageTextarea.value = '';
          })
          .catch((error) => {
            submitButton.disabled = false;
            Swal.fire({
              icon: 'error',
              title: 'Oops...',
              footer: `<h4>${(error.error || error)}</h4>`
            });
          });
      });
    </script>
  </body>
</html>
